openapi: 3.1.0
x-stoplight:
  id: rpkqjj7g6hmz6
info:
  title: DCSA OpenAPI specification for Operational Booking Forecast
  version: 1.0.0-Beta-1
  summary: Contains all the forecasted loading per port (full/empty and specials) for the entire region and is submitted from the partner to the vessel operator to allow port planning and capacity management of the vessel while in the specific region. The OBF should remain within the partner’s agreed slot/weight allocation.
  description: |
    Contains all the forecasted loading per port (full/empty and specials) for the entire region and is submitted from the partner to the vessel operator to allow port planning and capacity management of the vessel while in the specific region. The OBF should remain within the partner’s agreed slot/weight allocation.
  license:
    url: 'https://www.apache.org/licenses/LICENSE-2.0.html'
    name: Apache 2.0
  contact:
    name: Digital Container Shipping Association (DCSA)
    url: 'https://dcsa.org/'
    email: info@dcsa.org
servers:
  - url: 'https://dcsa.org/cbf'
tags:
  - name: VSA Partner
  - name: Vessel Operator
paths:
  /v1/booking-forecasts:
    parameters: []
    get:
      summary: Fetch Booking Forecast
      tags:
        - VSA Partner
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BookingForecast'
            application/xml:
              schema:
                $ref: '#/components/schemas/BookingForecast'
          headers:
            API-Version:
              $ref: ../../models/Headers.yaml#/components/headers/API-Version
        '400':
          description: Invalid request for booking forecast.
          content:
            application/json:
              schema:
                $ref: ../../models/ErrorResponse.yaml
              examples:
                Invalid GET Request:
                  value:
                    httpMethod: GET
                    requestUri: 'https://dcsa.org/dcsa/cbf/v1/booking-forcast'
                    statusCode: 400
                    statusCodeText: Bad Request
                    errorMessage: Either carrierServiceCode or universalServiceReference must be provided.
                    providerCorrelationID: 4426d965-0dd8-4005-8c63-dc68b01c4962
                    errorDateTime: '2019-11-12T07:41:00+08:30'
                    errors: []
        '404':
          description: Booking forecast not foound.
          content:
            application/json:
              schema:
                $ref: ../../models/ErrorResponse.yaml
      operationId: get-booking-forecast-by-reference
      description: |-
        Fetch the booking forecast by either the `carrierServiceCode` or the `universalServiceReference`.\
        Either one is **REQUIRED** but not both when fetching the booking forcast.
      parameters:
        - schema: {}
          in: query
          name: carrierServiceCode
          description: |-
            The carrier-specific code of the service for which the schedule details are published.\
            **REQUIRED** if `universalServiceReference` is not provided.
        - schema:
            type: string
          in: query
          name: universalServiceReference
          description: |-
            A global unique service reference, as per DCSA standard, agreed by VSA partners for the service. \
            **REQUIRED** if `carrierServiceCode` is not provided.
        - schema:
            type: string
          in: query
          name: vesselIMONumber
          description: 'The unique reference for a registered Vessel. The reference is the International Maritime Organisation (IMO) number, also sometimes known as the Lloyd''s register code, which does not change during the lifetime of the vessel'
        - schema:
            type: string
          in: query
          name: carrierImportVoyageNumber
          description: The carrier-specific identifier of the import Voyage.
        - schema:
            type: string
          in: query
          name: universalImportVoyageReference
          description: Universal voyage reference for the import Voyage
  /v1/booking-forecast:
    post:
      summary: Submit A Booking Forecast
      tags:
        - Vessel Operator
      responses:
        '204':
          description: No Content
        '400':
          description: Bad booking forecast request.
          content:
            application/json:
              schema:
                $ref: ../../models/ErrorResponse.yaml
              examples:
                Example 1:
                  value:
                    httpMethod: GET
                    requestUri: 'https://dcsa.org/dcsa/dcsa-standard/v1/booking-forecast'
                    statusCode: 400
                    statusCodeText: Bad Request
                    errorMessage: The supplied data could not be accepted
                    providerCorrelationID: 4426d965-0dd8-4005-8c63-dc68b01c4962
                    errorDateTime: '2019-11-12T07:41:00+08:30'
                    errors:
                      - errorCode: 7003
                        field: location.facilityCode
                        value: SG SIN WHS
                        reason: invalidQuery
                        message: Spaces not allowed in facility code
      operationId: create-v1-booking-forecast
      description: Submits a Booking forecast.
      parameters:
        - $ref: ../../models/APIVersionHeader.yaml
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BookingForecast'
        description: ''
components:
  schemas:
    BookingForecast:
      title: BookingForecast
      x-stoplight:
        id: keuoy8j4qkve1
      type: object
      properties:
        partnerIdentity:
          $ref: '#/components/schemas/PartnerIdentity'
        carrierServiceName:
          type: string
          pattern: ^\S+(\s+\S+)*$
          maxLength: 50
          example: Great Lion Service
          description: The name of a service as specified by the carrier
        carrierServiceCode:
          type: string
          pattern: ^\S+(\s+\S+)*$
          maxLength: 11
          example: FE1
          description: The carrier-specific code of the service for which the schedule details are published.
        universalServiceReference:
          type: string
          description: 'A global unique service reference, as per DCSA standard, agreed by VSA partners for the service. The service reference must match the regular expression pattern: SR\d{5}[A-Z]. The letters SR followed by 5 digits, followed by a checksum-character as a capital letter from A to Z.'
          example: SR12345A
          maxLength: 8
          pattern: '^SR\d{5}[A-Z]$'
        vessels:
          type: array
          items:
            $ref: '#/components/schemas/Vessel'
      required:
        - partnerIdentity
        - carrierServiceName
        - vessels
      examples:
        - partnerIdentity:
            code: MMCU
            codeListProvider: NMFTA
            agreementTypeCode: VSA
          carrierServiceName: Great Lion Service
          carrierServiceCode: FE1
          universalServiceReference: SR12345A
          vessels:
            - vesselOperatorSMDGLinerCode: HLC
              vesselIMONumber: '9321483'
              vesselName: King of the Seas
              forecasts:
                - portVisitReference: NLRTM1234589
                  transportCallReference: da97d1e3-e546-4647-891b-3f57e04b886b
                  carrierImportVoyageNumber: 2103N
                  carrierExportVoyageNumber: 2103S
                  universalImportVoyageReference: 2103N
                  universalExportVoyageReference: 2103N
                  location:
                    locationName: Port of Amsterdam
                    locationType: UNLO
                    UNLocationCode: FRPAR
                  loadLadenContainers:
                    equipmentSizeCode: '20'
                    averageGrossWeight: 0
                    unitsNonDG:
                      total: 0
                      totalPlugs: 0
                    unitsDG:
                      total: 0
                      totalPlugs: 0
                    discharge:
                      - portVisitReference: string
                        transportCallReference: string
                        location:
                          locationName: Port of Amsterdam
                          locationType: FACS
                          UNLocationCode: FRPAR
                          facilitySMDGCode: ADT
                        equipmentSizeCode: '20'
                        averageGrossWeight: 0
                        unitsNonDG:
                          total: 0
                          totalPlugs: 0
                        unitsDG:
                          total: 0
                          totalPlugs: 0
                  loadEmptyContainers:
                    equipmentSizeCode: '20'
                    averageGrossWeight: 0
                    units: 0
                    discharge:
                      - portVisitReference: string
                        transportCallReference: string
                        equipmentSizeCode: '20'
                        units: 0
                        averageGrossWeight: 0
                        location:
                          locationName: Port of Amsterdam
                          locationType: FACS
                          UNLocationCode: FRPAR
                          facilitySMDGCode: ADT
                  loadBreakBulk:
                    totalGrossWeight: 0
                    quantityTEU: 0
                    discharge:
                      - portVisitReference: string
                        transportCallReference: string
                        totalGrossWeight: 0
                        quantityTEU: 0
                        location:
                          locationName: Port of Amsterdam
                          locationType: FACS
                          UNLocationCode: FRPAR
                          facilitySMDGCode: ADT
                  loadOutOfGauge:
                    totalGrossWeight: 0
                    quantityTEU: 0
                    discharge:
                      - portVisitReference: string
                        transportCallReference: string
                        totalGrossWeight: 0
                        quantityTEU: 0
                        location:
                          locationName: Port of Amsterdam
                          locationType: FACS
                          UNLocationCode: FRPAR
                          facilitySMDGCode: ADT
    PartnerIdentity:
      title: PartnerIdentity
      x-stoplight:
        id: mnr99wlnor6is
      type: object
      properties:
        code:
          type: string
          format: regex
          pattern: ^\S+(\s+\S+)*$
          example: MMCU
          maxLength: 4
          description: SCAC code or SMDG Liner Code of the carrier.
        codeListProvider:
          type: string
          example: NMFTA
          description: The provider used for identifying the partner code
          enum:
            - SMDG
            - NMFTA
        agreementTypeCode:
          type: string
          example: VSA
          enum:
            - VSA
            - SCA
          description: |-
            Possible values are:

            - VSA (Vessel Sharing Agreement)
            - SCA (Slot Charter Agreement)
      required:
        - code
        - codeListProvider
        - agreementTypeCode
    Vessel:
      title: Vessel
      x-stoplight:
        id: 262a2bff1896c
      type: object
      properties:
        vesselOperatorSMDGLinerCode:
          type: string
          description: The carrier who is in charge of the vessel operation based on the SMDG code
          pattern: ^\S+(\s+\S+)*$
          maxLength: 10
          example: HLC
        vesselIMONumber:
          type: string
          pattern: '^\d{7}$'
          maxLength: 7
          example: '9321483'
          description: 'The unique reference for a registered Vessel. The reference is the International Maritime Organisation (IMO) number, also sometimes known as the Lloyd''s register code, which does not change during the lifetime of the vessel'
        vesselName:
          type: string
          pattern: ^\S+(\s+\S+)*$
          maxLength: 35
          example: King of the Seas
          description: The name of the Vessel given by the Vessel Operator and registered with IMO.
        forecasts:
          type: array
          items:
            $ref: '#/components/schemas/Forecast'
      required:
        - vesselOperatorSMDGLinerCode
        - vesselIMONumber
        - forecasts
      examples:
        - vesselOperatorSMDGLinerCode: HLC
          vesselIMONumber: '9321483'
          vesselName: King of the Seas
          forecasts:
            - portVisitReference: NLRTM1234589
              transportCallReference: da97d1e3-e546-4647-891b-3f57e04b886b
              carrierImportVoyageNumber: 2103N
              carrierExportVoyageNumber: 2103S
              universalImportVoyageReference: 2103N
              universalExportVoyageReference: 2103N
              location:
                locationName: Port of Amsterdam
                locationType: UNLO
                UNLocationCode: FRPAR
              loadLadenContainers:
                equipmentSizeCode: '20'
                averageGrossWeight: 0
                unitsNonDG:
                  total: 0
                  totalPlugs: 0
                unitsDG:
                  total: 0
                  totalPlugs: 0
                discharge:
                  - portVisitReference: string
                    transportCallReference: string
                    location:
                      locationName: Port of Amsterdam
                      locationType: FACS
                      UNLocationCode: FRPAR
                      facilitySMDGCode: ADT
                    equipmentSizeCode: '20'
                    averageGrossWeight: 0
                    unitsNonDG:
                      total: 0
                      totalPlugs: 0
                    unitsDG:
                      total: 0
                      totalPlugs: 0
              loadEmptyContainers:
                equipmentSizeCode: '20'
                averageGrossWeight: 0
                units: 0
                discharge:
                  - portVisitReference: string
                    transportCallReference: string
                    equipmentSizeCode: '20'
                    units: 0
                    averageGrossWeight: 0
                    location:
                      locationName: Port of Amsterdam
                      locationType: FACS
                      UNLocationCode: FRPAR
                      facilitySMDGCode: ADT
              loadBreakBulk:
                totalGrossWeight: 0
                quantityTEU: 0
                discharge:
                  - portVisitReference: string
                    transportCallReference: string
                    totalGrossWeight: 0
                    quantityTEU: 0
                    location:
                      locationName: Port of Amsterdam
                      locationType: FACS
                      UNLocationCode: FRPAR
                      facilitySMDGCode: ADT
              loadOutOfGauge:
                totalGrossWeight: 0
                quantityTEU: 0
                discharge:
                  - portVisitReference: string
                    transportCallReference: string
                    totalGrossWeight: 0
                    quantityTEU: 0
                    location:
                      locationName: Port of Amsterdam
                      locationType: FACS
                      UNLocationCode: FRPAR
                      facilitySMDGCode: ADT
    Forecast:
      title: Forecast
      x-stoplight:
        id: 299e1a5e0f756
      type: object
      properties:
        portVisitReference:
          type: string
          description: The unique reference that can be used to link different transportCallReferences to the same port visit. The reference is provided by the port to uniquely identify a port call.
          pattern: ^\S+(\s+\S+)*$
          example: NLRTM1234589
          maxLength: 50
        transportCallReference:
          type: string
          description: |-
            A carrier definied reference to a TransportCall.

            In the case the Means of Transport is a Vessel and the facility is a Port/Terminal - this reference should be considered a Terminal Call Reference
          example: da97d1e3-e546-4647-891b-3f57e04b886b
        carrierImportVoyageNumber:
          type: string
          example: 2103N
          description: The identifier of an import voyage. The carrier-specific identifier of the import Voyage.
          maxLength: 50
        carrierExportVoyageNumber:
          type: string
          description: The identifier of an export voyage. The carrier-specific identifier of the export Voyage.
          example: 2103S
          maxLength: 50
          pattern: ^\S+(\s+\S+)*$
        universalImportVoyageReference:
          type: string
          description: 'A global unique voyage reference for the import Voyage, as per DCSA standard, agreed by VSA partners for the voyage.'
          pattern: '^\d{2}[0-9A-Z]{2}[NEWS]$'
          example: 2103N
        universalExportVoyageReference:
          type: string
          description: 'A global unique voyage reference for the export Voyage, as per DCSA standard, agreed by VSA partners for the voyage.'
          pattern: '^\d{2}[0-9A-Z]{2}[NEWS]$'
          example: 2103N
        location:
          oneOf:
            - $ref: ../../models/UnLocationLocation.yaml
            - $ref: ../../models/FacilitySMDGLocation.yaml
        loadLadenContainers:
          $ref: '#/components/schemas/LadenContainer'
          description: Lists all the `LADEN` containers being loaded.
        loadEmptyContainers:
          $ref: '#/components/schemas/EmptyContainer'
          description: Lists all the `EMPTY` containers being loaded
        loadBreakBulk:
          $ref: '#/components/schemas/NonContainer'
        loadOutOfGauge:
          $ref: '#/components/schemas/NonContainer'
      required:
        - location
    LadenContainer:
      title: LadenContainer
      x-stoplight:
        id: kdfqf0ojv0wqd
      type: object
      description: A OBF specification for a particular container type.
      properties:
        equipmentSizeCode:
          type: string
          enum:
            - '20'
            - '40'
            - '45'
            - 20HC
            - 40HC
            - 45HC
          example: '20'
        averageGrossWeight:
          type: number
          format: float
        unitsNonDG:
          type: object
          properties:
            total:
              type: integer
              description: Total units non DG
            totalPlugs:
              type: integer
              description: Subtotal units non DG with plugs (reefer)
          required:
            - total
            - totalPlugs
        unitsDG:
          type: object
          properties:
            total:
              type: integer
              description: Total units DG
            totalPlugs:
              type: integer
              description: Subtotal units DG with plugs (reefer)
          required:
            - total
            - totalPlugs
        discharge:
          type: array
          description: Lists all the `LADEN` containers being discharged.
          items:
            $ref: '#/components/schemas/DischargeLadenContainer'
    DischargeLadenContainer:
      title: Discharge Laden Container
      type: object
      x-stoplight:
        id: eba602e7e427f
      properties:
        portVisitReference:
          type: string
        transportCallReference:
          type: string
        location:
          $ref: ../../models/FacilitySMDGLocation.yaml
        equipmentSizeCode:
          type: string
          enum:
            - '20'
            - '40'
            - '45'
            - 20HC
            - 40HC
            - 45HC
          example: '20'
        averageGrossWeight:
          type: number
          format: float
        unitsNonDG:
          type: object
          properties:
            total:
              type: integer
              description: Total units non DG
            totalPlugs:
              type: integer
              description: Subtotal units non DG with plugs (reefer)
          required:
            - total
            - totalPlugs
        unitsDG:
          type: object
          properties:
            total:
              type: integer
              description: Total units DG
            totalPlugs:
              type: integer
              description: Subtotal units DG with plugs (reefer)
          required:
            - total
            - totalPlugs
      required:
        - location
        - equipmentSizeCode
        - averageGrossWeight
    EmptyContainer:
      title: EmptyContainer
      x-stoplight:
        id: 2xjaqamt03lnq
      type: object
      description: A OBF specification for a particular container type.
      properties:
        equipmentSizeCode:
          type: string
          enum:
            - '20'
            - '40'
            - '45'
            - 20HC
            - 40HC
            - 45HC
          example: '20'
        averageGrossWeight:
          type: number
          format: float
        units:
          type: integer
          description: Total units non DG
        discharge:
          type: array
          description: Lists all the `EMPTY` containers being discharged.
          items:
            $ref: '#/components/schemas/DischargeEmptyContainer'
      required:
        - equipmentSizeCode
        - averageGrossWeight
        - units
        - discharge
    DischargeEmptyContainer:
      title: Discharge Empty Container
      type: object
      description: A OBF specification for a particular container type.
      x-stoplight:
        id: 3870fdc4937be
      properties:
        portVisitReference:
          type: string
        transportCallReference:
          type: string
        equipmentSizeCode:
          type: string
          enum:
            - '20'
            - '40'
            - '45'
            - 20HC
            - 40HC
            - 45HC
          example: '20'
        units:
          type: integer
          description: Total units non DG
        averageGrossWeight:
          type: number
          format: float
        location:
          $ref: ../../models/FacilitySMDGLocation.yaml
      required:
        - equipmentSizeCode
        - units
        - averageGrossWeight
        - location
    NonContainer:
      title: NonContainer
      x-stoplight:
        id: xyt1uk315okek
      type: object
      description: "\t\nA OBF specification for a particular container type."
      properties:
        totalGrossWeight:
          type: number
          format: float
        quantityTEU:
          type: number
          format: float
        discharge:
          type: array
          items:
            $ref: '#/components/schemas/DischargeNonContainer'
      required:
        - totalGrossWeight
        - quantityTEU
        - discharge
    DischargeNonContainer:
      title: Discharge Non Container
      type: object
      description: "\t\nA OBF specification for a particular container type."
      x-stoplight:
        id: b6466f6755447
      properties:
        portVisitReference:
          type: string
        transportCallReference:
          type: string
        totalGrossWeight:
          type: number
          format: float
        quantityTEU:
          type: number
          format: float
        location:
          $ref: ../../models/FacilitySMDGLocation.yaml
      required:
        - totalGrossWeight
        - quantityTEU
        - location
